
@{
    ViewBag.Title = "Watch";
}
<script src="~/Scripts/jquery-1.10.2.min.js"></script>
<script src="~/Scripts/jquery.signalR-2.0.2.min.js"></script>
<script src="~/signalr/hubs"></script>

<style>
    .scrollable{
        height: 400px;
        overflow-y: auto;
    }

    .console{
        list-style-type: none;
    }

    li.error{
        background-color: red;
        font-style: oblique;
   }

    li.info{
        background-color: green;
        font-style: oblique;
    }

</style>

@section scripts {
    <link href="//cdnjs.cloudflare.com/ajax/libs/toastr.js/2.0.1/css/toastr.min.css" rel="stylesheet" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/toastr.js/2.0.1/js/toastr.min.js"></script>
    
    <!--Script references. -->
    <!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-2.0.2.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <!--SignalR script to update the chat page and send messages.-->
    <script>
        $(function () {
            // Reference the auto-generated proxy for the hub.
            var chat = $.connection.eventHub;

            $.connection.hub.start().done(function () {
                chat.server.registerWatcher("@ViewBag.id");
             });

            chat.client.clientUpdate = function (message) {
                if (message.indexOf("Application") != -1) {
                    $(".remove-onceevent").hide();
                }

                toastr.info(message);
            };

            chat.client.logMessage = function (message, status) {
                // add this to a panel and inject into the dom.
                $(".remove-onceevent").hide();

                $('.console').prepend(
                    $('<li>').attr('class', status).append(
                        $('<span>').text(message)));
                //console.log(template);
                //$(".console").insertBefore(template);
            }

        });
    </script>
}




<div class="remove-onceevent">
        <h2>How To Add Watchr</h2>

        <h3>Download nuget package for logfornet</h3>
        <p>
            <br />
            <br />
            <pre>
                <code>
                    install-package lognet.watchr.appender
                </code>
            </pre>
        </p>

        <h3>Configure</h3>
        <p>
            In your app.config or web.config add a new key called 

            <pre>
            <code>
                &lt;add key="watchr.appid" value="@ViewBag.id" /&gt;
            </code>
            </pre>
            Additionally you will also need to add the appender like so

            <pre>
            <code>
                
                &lt;appender name="WatchrAppender" type="watcherclient.WatchrAppender"&gt;
                    &lt;layout type="log4net.Layout.PatternLayout"&gt;
                        &lt;conversionpattern value="%date [%thread] %-5level %logger [%ndc] - %message%newline" /&gt;
                    &lt;/layout&gt;
                &lt;/appender&gt;
                
            </code>
            </pre>
        </p>

        <h3> Deploy your application </h3>
        <p>
            Deploy Your Application.
        </p>

        <h3>Share This URL With Your Team</h3>
    <p class="copy-src">
        @Request.Url.AbsoluteUri
    </p>
</div>



<div class="scrollable">
     <ol class="container console">

     </ol>
</div>

